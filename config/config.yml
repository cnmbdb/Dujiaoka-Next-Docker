# D&J Studio 配置文件

server:
  host: 0.0.0.0
  port: 3000
  mode: debug  # debug 或 release (release 需强 JWT 密钥)

log:
  dir: ""  # 为空时使用当前运行目录/logs
  filename: app.log
  max_size_mb: 100
  max_backups: 7
  max_age_days: 30
  compress: true

database:
  driver: postgres  # sqlite / postgres
  dsn: host=dujiao-postgres port=5432 user=dujiao_user password=dujiao_password dbname=dujiao_db sslmode=disable
  pool:
    max_open_conns: 1
    max_idle_conns: 1
    conn_max_lifetime_seconds: 0  # 0 表示不限制
    conn_max_idle_time_seconds: 0  # 0 表示不限制

jwt:
  secret: a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
  expire_hours: 24  # Token 有效期（小时）

user_jwt:
  secret: z9y8x7w6v5u4t3s2r1q0p9o8n7m6l5k4j3i2h1g0f9e8d7c6b5a4
  expire_hours: 24  # 用户 Token 有效期（小时）
  remember_me_expire_hours: 168  # 记住我 Token 有效期（小时）

telegram_auth:
  enabled: false
  bot_username: ""  # Telegram Bot 用户名（不含 @）
  bot_token: ""     # Telegram Bot Token（敏感）
  login_expire_seconds: 300
  replay_ttl_seconds: 300

redis:
  enabled: true
  host: dujiao-redis
  port: 6379
  password: ""
  db: 0
  prefix: "dj"

queue:
  enabled: true
  host: dujiao-redis
  port: 6379
  password: ""
  db: 1
  concurrency: 10
  queues:
    default: 10
    critical: 5

upload:
  max_size: 10485760  # 最大上传文件大小（字节，默认 10MB）
  allowed_types:
    - image/jpeg
    - image/png
    - image/gif
    - image/webp
  allowed_extensions:
    - .jpg
    - .jpeg
    - .png
    - .gif
    - .webp
  max_width: 4096
  max_height: 4096

cors:
  allowed_origins:
    - "*"
  allowed_methods:
    - GET
    - POST
    - PUT
    - PATCH
    - DELETE
    - OPTIONS
  allowed_headers:
    - Content-Type
    - Content-Length
    - Accept-Encoding
    - Authorization
    - Cache-Control
    - X-Requested-With
    - X-CSRF-Token
  allow_credentials: true
  max_age: 600

security:
  login_rate_limit:
    window_seconds: 300
    max_attempts: 5
    block_seconds: 900
  password_policy:
    min_length: 8
    require_upper: true
    require_lower: true
    require_number: true
    require_special: false

email:
  enabled: false
  host: smtp.xxx.com
  port: 465
  username: your-username
  password: your-password
  from: your-email
  from_name: your-name
  use_tls: false
  use_ssl: true
  verify_code:
    expire_minutes: 10
    send_interval_seconds: 60
    max_attempts: 5
    length: 6

order:
  payment_expire_minutes: 15
