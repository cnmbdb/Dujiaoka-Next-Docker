# 登录问题修复说明

## 问题原因

1. **API_URL 配置错误**：Admin 容器中的 `API_URL=http://api:3000` 是 Docker 内部地址，浏览器无法访问
2. **登录路由错误**：前端可能使用了错误的路由

## 已修复

### 1. 设置正确的 API_URL

在 `.env` 文件中设置：
```bash
API_URL=http://localhost:3001
```

**说明**：
- 本地测试：`http://localhost:3001`
- 服务器部署：`http://服务器IP:3001` 或 `https://api.your-domain.com`

### 2. 正确的登录路由

- ✅ 正确：`POST /api/v1/admin/login`
- ❌ 错误：`POST /api/v1/admin/auth/login`

### 3. 重启服务使配置生效

```bash
docker compose restart admin user
# 或
docker compose down
docker compose up -d
```

---

## 测试登录

```bash
curl -X POST http://localhost:3001/api/v1/admin/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

---

## 检查管理员账号

```bash
docker compose exec dujiao-postgres psql -U dujiao_user -d dujiao_db -c "SELECT username FROM admins;"
```

如果没有管理员，删除数据库数据重新初始化：
```bash
docker compose down
rm -rf data/postgres/*
docker compose up -d
```
